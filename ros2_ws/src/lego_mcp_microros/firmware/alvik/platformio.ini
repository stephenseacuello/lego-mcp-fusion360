; LEGO MCP Alvik AGV Firmware
; PlatformIO configuration for ESP32-S3 with micro-ROS
;
; Build: pio run
; Upload: pio run --target upload
; Monitor: pio device monitor

[env:alvik_esp32s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; micro-ROS configuration
lib_deps =
    https://github.com/micro-ROS/micro_ros_platformio

; Build flags for micro-ROS
build_flags =
    -D MICRO_ROS_TRANSPORT_ARDUINO_WIFI
    -D MICRO_ROS_USE_WIFI
    -D ESP32_S3
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1

; Serial monitor
monitor_speed = 115200

; Extra scripts for micro-ROS
extra_scripts = pre:extra_script.py

; Memory configuration for micro-ROS
board_build.partitions = huge_app.csv

[env:alvik_esp32s3_serial]
; Alternative config for serial transport (USB)
extends = env:alvik_esp32s3
build_flags =
    -D MICRO_ROS_TRANSPORT_ARDUINO_SERIAL
    -D ESP32_S3
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1
