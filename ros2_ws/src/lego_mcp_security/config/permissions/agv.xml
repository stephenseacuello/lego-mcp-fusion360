<?xml version="1.0" encoding="UTF-8"?>
<!--
  DDS Permissions for AGV Fleet Node
  LEGO MCP Security - IEC 62443 Zone 2 (Supervisory)
-->
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation="http://www.omg.org/spec/DDS-SECURITY/20170901/omg_shared_ca_permissions.xsd">
  <permissions>

    <grant name="agv_fleet_permissions">
      <subject_name>CN=agv_fleet_node,O=LegoMCP,OU=Zone2</subject_name>

      <validity>
        <not_before>2024-01-01T00:00:00</not_before>
        <not_after>2026-01-01T00:00:00</not_after>
      </validity>

      <allow_rule>
        <domains>
          <id>0</id>
        </domains>

        <publish>
          <topics>
            <topic>/lego_mcp/agv/*</topic>
            <topic>/lego_mcp/fleet/*</topic>
            <topic>/lego_mcp/heartbeat/agv</topic>
            <topic>/nav2/*</topic>
            <topic>/tf</topic>
            <topic>/diagnostics</topic>
          </topics>
        </publish>

        <subscribe>
          <topics>
            <topic>/lego_mcp/agv/*</topic>
            <topic>/lego_mcp/orchestrator/*</topic>
            <topic>/safety/estop_status</topic>
            <topic>/lego_mcp/estop</topic>
            <topic>/scan</topic>
            <topic>/odom</topic>
            <topic>/map</topic>
          </topics>
        </subscribe>
      </allow_rule>

      <default>DENY</default>
    </grant>

  </permissions>
</dds>
