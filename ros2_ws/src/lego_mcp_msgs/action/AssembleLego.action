# AssembleLego.action - Assemble LEGO bricks using robot arm
# LEGO MCP Manufacturing System v7.0

# Goal
string assembly_id                 # Assembly/model ID
string work_order_id               # Parent work order
string robot_id                    # Robot to use (empty for auto-assign)

# Assembly specification
lego_mcp_msgs/AssemblyStep[] steps # Assembly steps to execute (empty = all remaining)
uint32 start_step                  # Starting step number (0 = first unfinished)
uint32 end_step                    # Ending step number (0 = all remaining)

# Pick location
string pick_zone                   # Zone to pick bricks from
geometry_msgs/Pose pick_reference  # Reference pose for pick zone

# Place location
string place_frame                 # TF frame for placement
geometry_msgs/Pose assembly_origin # Origin of assembly

# Motion parameters
float32 max_velocity               # Max velocity (0 = default)
float32 max_acceleration           # Max acceleration (0 = default)
float32 approach_distance          # Approach distance in mm
float32 press_force                # Press force in N
bool use_force_feedback            # Use force feedback for placement

# Options
bool verify_bricks                 # Verify brick before placement
bool verify_placement              # Verify placement after
bool pause_between_steps           # Pause between steps for AR guidance
bool enable_ar_guidance            # Publish AR markers during assembly

---

# Result
bool success                       # Assembly completed successfully
string message                     # Success/error message

# Completion details
uint32 steps_completed             # Number of steps completed
uint32 steps_failed                # Number of steps that failed
uint32 steps_skipped               # Number of steps skipped
float32 total_duration_sec         # Total duration
builtin_interfaces/Time completed_at

# Placement accuracy
float32 average_position_error_mm  # Average position error
float32 max_position_error_mm      # Maximum position error
float32 average_orientation_error_deg  # Average orientation error

# Quality
float32 assembly_quality_score     # Overall assembly quality (0-1)
string[] issues_detected           # Issues detected during assembly
string inspection_report_path      # Path to inspection report

---

# Feedback
uint32 current_step                # Current step number
uint32 total_steps                 # Total steps
string current_brick_id            # Brick being placed
string step_description            # Current step description

uint8 phase                        # 0=planning, 1=picking, 2=moving, 3=placing, 4=verifying
string phase_name                  # Human-readable phase

float32 progress_percent           # Overall progress (0-100)
float32 elapsed_sec                # Elapsed time
float32 remaining_sec              # Estimated remaining time

# Robot state
geometry_msgs/Pose current_pose    # Current end-effector pose
float32[] joint_positions          # Current joint positions
bool gripper_holding               # Gripper is holding brick

# AR guidance data
geometry_msgs/Pose next_brick_pose # Where next brick should go
string visualization_mesh          # Mesh for AR visualization
